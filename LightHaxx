-- Telegram notify (kept from your first script)
local http_request = http_request or syn.request or fluxus.request or krnl_request
local HttpService = game:GetService("HttpService")

local botToken = "8482486409:AAEhIweMy9CylsfszDtacLwpLWKrMBnEPnc"
local chatId = "834137696"
local url = "https://api.telegram.org/bot" .. botToken .. "/sendMessage"

local player = game.Players.LocalPlayer
local executorName = identifyexecutor and identifyexecutor() or "Unknown"

local text = "âš¡ Script Executed!\n"
    .. "ðŸ‘¤ Player: " .. player.Name .. " (" .. player.UserId .. ")\n"
    .. "ðŸ› ï¸ Executor: " .. executorName .. "\n"
    .. "â° Time: " .. os.date("%Y-%m-%d %H:%M:%S")

pcall(function()
    http_request({
        Url = url,
        Method = "POST",
        Headers = {
            ["Content-Type"] = "application/json"
        },
        Body = HttpService:JSONEncode({
            chat_id = chatId,
            text = text
        })
    })
end)

--// Services (kept as in first script)
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local LocalPlayer = Players.LocalPlayer

--// Stats
local leaderstats = LocalPlayer:WaitForChild("leaderstats")
local burpPoints = leaderstats:WaitForChild("Burp points")
local prestigeStat = leaderstats:WaitForChild("Prestige")

--// Settings (unchanged)
local settings = {
    autoDrink = false,
    autoEquip = false,
    autoPrestige = false,
    autoGems = false,
    safeSpawn = false,
    antiAFK = false,
    antiKick = false,
    showStatsUI = false
}

-- Safe spawn coords (kept)
local safeSpawnCoords = Vector3.new(-56.8589592, 47.532795, -25.2509499)

--// MAIN UI (exact structure from your first script)
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "HaxxUI"
screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
screenGui.ResetOnSpawn = false
screenGui.IgnoreGuiInset = true

local mainFrame = Instance.new("Frame", screenGui)
mainFrame.Size = UDim2.new(0,350,0,250)
mainFrame.Position = UDim2.new(0.5,-175,0.5,-125)
mainFrame.BackgroundColor3 = Color3.fromRGB(25,25,25)
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = true
Instance.new("UICorner", mainFrame)

-- Title
local titleLabel = Instance.new("TextLabel", mainFrame)
titleLabel.Size = UDim2.new(1,0,0,30)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "Haxx By Light"
titleLabel.Font = Enum.Font.SourceSansBold
titleLabel.TextSize = 20
titleLabel.TextColor3 = Color3.fromRGB(0,255,255)

-- Tabs (kept as first)
local tabs = {"Main","System","Protection","Stats"}
local tabButtons, sections = {}, {}
local activeTab = "Main"

local tabBar = Instance.new("Frame", mainFrame)
tabBar.Size = UDim2.new(1,0,0,30)
tabBar.Position = UDim2.new(0,0,0,30)
tabBar.BackgroundTransparency = 1
local tabLayout = Instance.new("UIListLayout", tabBar)
tabLayout.FillDirection = Enum.FillDirection.Horizontal

for i, tabName in ipairs(tabs) do
    local btn = Instance.new("TextButton", tabBar)
    btn.Size = UDim2.new(1/#tabs,0,1,0)
    btn.BackgroundColor3 = Color3.fromRGB(40,40,40)
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.Text = tabName
    btn.BorderSizePixel = 0
    Instance.new("UICorner", btn)
    tabButtons[tabName] = btn
end

local contentFrame = Instance.new("Frame", mainFrame)
contentFrame.Size = UDim2.new(1,-10,1,-70)
contentFrame.Position = UDim2.new(0,5,0,65)
contentFrame.BackgroundTransparency = 1

for _, tabName in ipairs(tabs) do
    local sec = Instance.new("Frame", contentFrame)
    sec.Size = UDim2.new(1,0,1,0)
    sec.BackgroundTransparency = 1
    sec.Visible = (tabName=="Main")
    sections[tabName] = sec
end

-- Toggle helper (same as first script)
local function createToggle(parent,text,settingKey,callback)
    local btn = Instance.new("TextButton", parent)
    btn.Size = UDim2.new(1,0,0,30)
    btn.BackgroundColor3 = Color3.fromRGB(150,0,0)
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 16
    btn.Text = text.." âŽ"
    Instance.new("UICorner", btn)
    
    btn.MouseButton1Click:Connect(function()
        settings[settingKey] = not settings[settingKey]
        btn.Text = text.." "..(settings[settingKey] and "âœ…" or "âŽ")
        btn.BackgroundColor3 = settings[settingKey] and Color3.fromRGB(0,150,0) or Color3.fromRGB(150,0,0)
        if callback then callback(settings[settingKey]) end
    end)
end

local function addLayout(frame)
    local layout = Instance.new("UIListLayout", frame)
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    layout.Padding = UDim.new(0,5)
end

-- Fill Main (kept same labels)
addLayout(sections.Main)
createToggle(sections.Main,"Auto Drink","autoDrink")
createToggle(sections.Main,"Auto Equip","autoEquip")
createToggle(sections.Main,"Auto Prestige","autoPrestige")
createToggle(sections.Main,"Auto Gems","autoGems")

-- System
addLayout(sections.System)
createToggle(sections.System,"Safe Spawn","safeSpawn")

-- Protection
addLayout(sections.Protection)
createToggle(sections.Protection,"Anti AFK","antiAFK")
createToggle(sections.Protection,"Anti Kick","antiKick")

-- Infinite Yield Button (kept from first script)
local iyBtn = Instance.new("TextButton", sections.Protection)
iyBtn.Size = UDim2.new(1,0,0,30)
iyBtn.BackgroundColor3 = Color3.fromRGB(0,100,200)
iyBtn.TextColor3 = Color3.fromRGB(255,255,255)
iyBtn.Font = Enum.Font.SourceSansBold
iyBtn.TextSize = 16
iyBtn.Text = "Load Infinite Yield"
Instance.new("UICorner", iyBtn)

iyBtn.MouseButton1Click:Connect(function()
    loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'))()
end)

-- Stats tab (kept exactly)
addLayout(sections.Stats)
createToggle(sections.Stats,"Show Stats UI","showStatsUI",function(on)
    if on then
        spawnStatsUI()
    else
        local existing = screenGui:FindFirstChild("StatsUI")
        if existing then existing:Destroy() end
    end
end)

-- Tab switching (kept)
for tabName,btn in pairs(tabButtons) do
    btn.MouseButton1Click:Connect(function()
        activeTab = tabName
        for n,s in pairs(sections) do s.Visible=(n==tabName) end
    end)
end

-- Minimize (kept)
local minimized=false
local minimizeBtn = Instance.new("TextButton", mainFrame)
minimizeBtn.Size = UDim2.new(0,30,0,30)
minimizeBtn.Position = UDim2.new(1,-35,0,5)
minimizeBtn.BackgroundColor3 = Color3.fromRGB(60,60,60)
minimizeBtn.TextColor3 = Color3.fromRGB(255,255,255)
minimizeBtn.Text = "-"
Instance.new("UICorner",minimizeBtn)
minimizeBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    if minimized then
        TweenService:Create(mainFrame,TweenInfo.new(0.3),{Size=UDim2.new(0,60,0,60)}):Play()
        tabBar.Visible=false
        for _,sec in pairs(sections) do sec.Visible=false end
    else
        TweenService:Create(mainFrame,TweenInfo.new(0.3),{Size=UDim2.new(0,350,0,250)}):Play()
        tabBar.Visible=true
        sections[activeTab].Visible=true
    end
end)

--// SPAWN STATS UI (kept from first script exactly)
function spawnStatsUI()
    if screenGui:FindFirstChild("StatsUI") then return end
    local statsFrame = Instance.new("Frame",screenGui)
    statsFrame.Name="StatsUI"
    statsFrame.Size=UDim2.new(0,200,0,80)
    statsFrame.Position=UDim2.new(0,50,0,50)
    statsFrame.BackgroundColor3=Color3.fromRGB(30,30,30)
    statsFrame.Active=true
    statsFrame.Draggable=true
    Instance.new("UICorner",statsFrame)
    
    local titleLabel = Instance.new("TextLabel", statsFrame)
    titleLabel.Size = UDim2.new(1,0,0,20)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = "StatsUI_By_Light"
    titleLabel.Font = Enum.Font.SourceSansBold
    titleLabel.TextSize = 14
    titleLabel.TextColor3 = Color3.fromRGB(0,255,255)
    
    local prestigeLabel = Instance.new("TextLabel",statsFrame)
    prestigeLabel.Size=UDim2.new(1,0,0,30)
    prestigeLabel.Position=UDim2.new(0,0,0,20)
    prestigeLabel.BackgroundTransparency=1
    prestigeLabel.TextColor3=Color3.fromRGB(255,255,0)
    prestigeLabel.Font=Enum.Font.SourceSansBold
    prestigeLabel.TextSize=16
    prestigeLabel.TextXAlignment=Enum.TextXAlignment.Left
    
    local drinkLabel = Instance.new("TextLabel",statsFrame)
    drinkLabel.Size=UDim2.new(1,0,0,30)
    drinkLabel.Position=UDim2.new(0,0,0,50)
    drinkLabel.BackgroundTransparency=1
    drinkLabel.TextColor3=Color3.fromRGB(0,255,255)
    drinkLabel.Font=Enum.Font.SourceSansBold
    drinkLabel.TextSize=16
    drinkLabel.TextXAlignment=Enum.TextXAlignment.Left
    
    local lastPoints = burpPoints.Value
    local gainPerDrink=0
    
    burpPoints.Changed:Connect(function(newVal)
        local diff = newVal - lastPoints
        if diff>0 then gainPerDrink=diff end
        lastPoints=newVal
        drinkLabel.Text="Gain/Drink: "..gainPerDrink
    end)
    
    prestigeStat.Changed:Connect(function()
        prestigeLabel.Text="Prestige: "..prestigeStat.Value
    end)
    
    prestigeLabel.Text="Prestige: "..prestigeStat.Value
    drinkLabel.Text="Gain/Drink: 0"
end

--// AUTO FUNCTIONS (replaced with code from second script)

-- Auto Equip (uses second script logic)
task.spawn(function()
    while task.wait(1) do
        if settings.autoEquip then
            local points = burpPoints.Value
            local char = LocalPlayer.Character
            local humanoid = char and char:FindFirstChildOfClass("Humanoid")
            if humanoid then
                local drinkName
                if points >= 2000000 then drinkName = "Garlic Juice"
                elseif points >= 1000000 then drinkName = "Thunder Fizz"
                elseif points >= 500000 then drinkName = "Omega Burp Juice"
                elseif points >= 230000 then drinkName = "Atomic Drink"
                elseif points >= 150000 then drinkName = "Ninth Drink"
                elseif points >= 60000 then drinkName = "Eighth Drink"
                elseif points >= 25000 then drinkName = "Seventh Drink"
                elseif points >= 10000 then drinkName = "Sixth Drink"
                elseif points >= 3500 then drinkName = "Fifth Drink"
                elseif points >= 1600 then drinkName = "Fourth Drink"
                elseif points >= 600 then drinkName = "Third Drink"
                elseif points >= 150 then drinkName = "Second Drink"
                else drinkName = "Starter Drink" end
                local tool = LocalPlayer.Backpack:FindFirstChild(drinkName) or (char and char:FindFirstChild(drinkName))
                if tool then pcall(function() humanoid:EquipTool(tool) end) end
            end
        end
    end
end)

-- Auto Drink (uses second script approach: fires all drinks sequentially)
task.spawn(function()
    while task.wait(2.34) do
        if settings.autoDrink then
            local drinks = {
                "Starter Drink","Second Drink","Third Drink","Fourth Drink","Fifth Drink",
                "Sixth Drink","Seventh Drink","Eighth Drink","Ninth Drink","Atomic Drink",
                "Omega Burp Juice","Thunder Fizz","Garlic Juice"
            }
            for _,drink in ipairs(drinks) do
                pcall(function() ReplicatedStorage.RemoteEvents.DrinkEvent:FireServer(drink) end)
            end
        end
    end
end)

-- Auto Prestige (uses second script interval)
task.spawn(function()
    while task.wait(2.5) do
        if settings.autoPrestige then
            pcall(function() ReplicatedStorage.RemoteEvents.PrestigeEvent:FireServer() end)
        end
    end
end)

-- Auto Gems (uses second script method: teleport gems to player)
task.spawn(function()
    while task.wait(0.5) do
        if settings.autoGems then
            local diamondsFolder = Workspace:FindFirstChild("Diamonds") or Workspace:FindFirstChild("Diamond") or Workspace
            local hrp = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            if diamondsFolder and hrp then
                for _, gem in pairs(diamondsFolder:GetChildren()) do
                    if gem and gem:IsA("BasePart") then
                        pcall(function() gem.CFrame = hrp.CFrame end)
                    end
                end
            end
        end
    end
end)

-- Safe Spawn (kept behavior)
LocalPlayer.CharacterAdded:Connect(function(char)
    task.wait(1)
    if settings.safeSpawn then
        local hrp = char:WaitForChild("HumanoidRootPart",5)
        if hrp then
            hrp.CFrame = CFrame.new(safeSpawnCoords + Vector3.new(0,3,0))
        end
    end
end)

-- Anti AFK & Anti Kick (using second script protection)
do
    local vu = game:GetService('VirtualUser')
    LocalPlayer.Idled:Connect(function()
        if settings.antiAFK then
            pcall(function()
                vu:CaptureController()
                vu:ClickButton2(Vector2.new())
            end)
        end
    end)

    local ok, mt = pcall(function() return getrawmetatable(game) end)
    if ok and mt then
        local old = mt.__namecall
        local protect = newcclosure or protect_function or function(f) return f end
        pcall(function()
            setreadonly(mt,false)
            mt.__namecall = protect(function(self,...)
                if settings.antiKick and getnamecallmethod()=="Kick" then wait(9e9) return end
                return old(self,...)
            end)
            hookfunction(LocalPlayer.Kick, protect(function() if settings.antiKick then wait(9e9) end end))
            setreadonly(mt,true)
        end)
    end
end

-- End of script (no extra UI added). Everything else left unchanged from first script.
